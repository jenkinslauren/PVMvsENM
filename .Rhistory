i <- i + 1
}
i <- 1
yr <- 120000
v <- 'BIO19'
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
i <- 1
yr <- 120000
v <- 'cloudiness'
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
i <- 1
yr <- 120000
v <- 'relative_humidity'
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
createRasters <- function(varName) {
if (grepl('bio', varName)) {
upperVar <- toupper(varName)
} else {
upperVar <- varName
}
outfile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', upperVar, '/', upperVar, '.tif')
var <- brick(file, varname = upperVar, level = 1)
# can check this by overlaying the US map and checking edges
projection(var) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
writeRaster(stack(var), outfile, bylayer=TRUE, format='GTiff', overwrite = T)
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', upperVar),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
allrasters <- stack(allrasters)
}
rasters <- c('bio1')
lapply(rasters, createRasters)
lapply(rasters, createRasters)
variables <- c('BIO1')
lapply(varaibles, run)
changeFileName <- function(i, year, var) {
oldFile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '/', var, '_' , i, '.tif')
# print(paste0("Old file name: ", oldFile))
newFile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '/', var, '_' , year, 'ybp.tif')
# print(paste0("New file name: ", newFile))
file.rename(oldFile, newFile)
}
run <- function(var) {
i <- 1
yr <- 120000
v <- var
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
}
lapply(varaibles, run)
lapply(variables, run)
# check multiple timesteps
rasterList <- list.files(path = './data_and_analyses/env_data/Beyer/tifs/BIO6',
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
allrasters <- stack(allrasters)
plot(allrasters)
zero <- cellStats(allrasters$BIO6_0ybp, mean)
last <- cellStats(allrasters$BIO6_120000ybp, mean)
print(paste0('0 ybp = ', zero, " ... 120,000 ybp = ", last))
last <- cellStats(allrasters$BIO6_118000ybp, mean)
last <- cellStats(allrasters$BIO6_116000ybp, mean)
last <- cellStats(allrasters$BIO6_114000ybp, mean)
last <- cellStats(allrasters$BIO6_112000ybp, mean)
last <- cellStats(allrasters$BIO6_110000ybp, mean)
last <- cellStats(allrasters$BIO6_108000ybp, mean)
last <- cellStats(allrasters$BIO6_21000ybp, mean)
last <- cellStats(allrasters$BIO6_20000ybp, mean)
last <- cellStats(allrasters$BIO6_15000ybp, mean)
stack <- list()
for(i in 1:12){
f <- brick(file, varname = 'cloudiness', level = i)
stack <- append(stack, f)
}
View(stack)
meansStack <- stack(stack)
means <- means()
means <- list()
means[[i]] <- calc(meansStack, fun = mean, na.rm = T)
View(means)
plot(means[[12]])
plot(stack[1])
plot(stack[[1]])
View(means)
plot(means)
plot(means[[1]])
View(meansStack)
stack <- list()
means <- list()
for(i in 1:12){
f <- list(brick(file, varname = 'cloudiness', level = i))
stack <- append(stack, f)
}
View(stack)
stack[[1]]
plot(stack[[1][1]])
plot(stack[[1]][1])
meansStack <- list()
s <- stack(stack[[1]]$X.21000, stack[[1]]$X.20000, stack[[1]]$X.19000, stack[[1]]$X.18000,
stack[[1]]$X.17000, stack[[1]]$X.16000, stack[[1]]$X.15000, stack[[1]]$X.14000,
stack[[1]]$X.13000, stack[[1]]$X.12000, stack[[1]]$X.11000, stack[[1]]$X.10000,
stack[[1]]$X.9000, stack[[1]]$X.8000, stack[[1]]$X.7000, stack[[1]]$X.6000,
stack[[1]]$X.5000, stack[[1]]$X.4000, stack[[1]]$X.3000, stack[[1]]$X.2000,
stack[[1]]$X.1000, stack[[1]]$X0)
meansStack <- list()
s <- stack(stack[[1]]$X.21000, stack[[2]]$X.21000, stack[[3]]$X.21000, stack[[4]]$X.21000,
stack[[5]]$X.21000, stack[[6]]$X.21000, stack[[7]]$X.21000, stack[[8]]$X.21000,
stack[[9]]$X.21000, stack[[10]]$X.21000, stack[[11]]$X.21000, stack[[12]]$X.21000)
meansStack <- stack(stack)
meansStack <- list()
s <- stack(stack[[1]]$X.21000, stack[[2]]$X.21000, stack[[3]]$X.21000, stack[[4]]$X.21000,
stack[[5]]$X.21000, stack[[6]]$X.21000, stack[[7]]$X.21000, stack[[8]]$X.21000,
stack[[9]]$X.21000, stack[[10]]$X.21000, stack[[11]]$X.21000, stack[[12]]$X.21000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.20000, stack[[2]]$X.20000, stack[[3]]$X.20000, stack[[4]]$X.20000,
stack[[5]]$X.20000, stack[[6]]$X.20000, stack[[7]]$X.20000, stack[[8]]$X.20000,
stack[[9]]$X.20000, stack[[10]]$X.20000, stack[[11]]$X.20000, stack[[12]]$X.20000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.19000, stack[[2]]$X.19000, stack[[3]]$X.19000, stack[[4]]$X.19000,
stack[[5]]$X.19000, stack[[6]]$X.19000, stack[[7]]$X.19000, stack[[8]]$X.19000,
stack[[9]]$X.19000, stack[[10]]$X.19000, stack[[11]]$X.19000, stack[[12]]$X.19000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.18000, stack[[2]]$X.18000, stack[[3]]$X.18000, stack[[4]]$X.18000,
stack[[5]]$X.18000, stack[[6]]$X.18000, stack[[7]]$X.18000, stack[[8]]$X.18000,
stack[[9]]$X.18000, stack[[10]]$X.18000, stack[[11]]$X.18000, stack[[12]]$X.18000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.17000, stack[[2]]$X.17000, stack[[3]]$X.17000, stack[[4]]$X.17000,
stack[[5]]$X.17000, stack[[6]]$X.17000, stack[[7]]$X.17000, stack[[8]]$X.17000,
stack[[9]]$X.17000, stack[[10]]$X.17000, stack[[11]]$X.17000, stack[[12]]$X.17000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.16000, stack[[2]]$X.16000, stack[[3]]$X.16000, stack[[4]]$X.16000,
stack[[5]]$X.16000, stack[[6]]$X.16000, stack[[7]]$X.16000, stack[[8]]$X.16000,
stack[[9]]$X.16000, stack[[10]]$X.16000, stack[[11]]$X.16000, stack[[12]]$X.16000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.15000, stack[[2]]$X.15000, stack[[3]]$X.15000, stack[[4]]$X.15000,
stack[[5]]$X.15000, stack[[6]]$X.15000, stack[[7]]$X.15000, stack[[8]]$X.15000,
stack[[9]]$X.15000, stack[[10]]$X.15000, stack[[11]]$X.15000, stack[[12]]$X.15000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.14000, stack[[2]]$X.14000, stack[[3]]$X.14000, stack[[4]]$X.14000,
stack[[5]]$X.14000, stack[[6]]$X.14000, stack[[7]]$X.14000, stack[[8]]$X.14000,
stack[[9]]$X.14000, stack[[10]]$X.14000, stack[[11]]$X.14000, stack[[12]]$X.14000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.13000, stack[[2]]$X.13000, stack[[3]]$X.13000, stack[[4]]$X.13000,
stack[[5]]$X.13000, stack[[6]]$X.13000, stack[[7]]$X.13000, stack[[8]]$X.13000,
stack[[9]]$X.13000, stack[[10]]$X.13000, stack[[11]]$X.13000, stack[[12]]$X.13000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.12000, stack[[2]]$X.12000, stack[[3]]$X.12000, stack[[4]]$X.12000,
stack[[5]]$X.12000, stack[[6]]$X.12000, stack[[7]]$X.12000, stack[[8]]$X.12000,
stack[[9]]$X.12000, stack[[10]]$X.12000, stack[[11]]$X.12000, stack[[12]]$X.12000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.11000, stack[[2]]$X.11000, stack[[3]]$X.11000, stack[[4]]$X.11000,
stack[[5]]$X.11000, stack[[6]]$X.11000, stack[[7]]$X.11000, stack[[8]]$X.11000,
stack[[9]]$X.11000, stack[[10]]$X.11000, stack[[11]]$X.11000, stack[[12]]$X.11000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.10000, stack[[2]]$X.10000, stack[[3]]$X.10000, stack[[4]]$X.10000,
stack[[5]]$X.10000, stack[[6]]$X.10000, stack[[7]]$X.10000, stack[[8]]$X.10000,
stack[[9]]$X.10000, stack[[10]]$X.10000, stack[[11]]$X.10000, stack[[12]]$X.10000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.9000, stack[[2]]$X.9000, stack[[3]]$X.9000, stack[[4]]$X.9000,
stack[[5]]$X.9000, stack[[6]]$X.9000, stack[[7]]$X.9000, stack[[8]]$X.9000,
stack[[9]]$X.9000, stack[[10]]$X.9000, stack[[11]]$X.9000, stack[[12]]$X.9000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.8000, stack[[2]]$X.8000, stack[[3]]$X.8000, stack[[4]]$X.8000,
stack[[5]]$X.8000, stack[[6]]$X.8000, stack[[7]]$X.8000, stack[[8]]$X.8000,
stack[[9]]$X.8000, stack[[10]]$X.8000, stack[[11]]$X.8000, stack[[12]]$X.8000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.7000, stack[[2]]$X.7000, stack[[3]]$X.7000, stack[[4]]$X.7000,
stack[[5]]$X.7000, stack[[6]]$X.7000, stack[[7]]$X.7000, stack[[8]]$X.7000,
stack[[9]]$X.7000, stack[[10]]$X.7000, stack[[11]]$X.7000, stack[[12]]$X.7000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.6000, stack[[2]]$X.6000, stack[[3]]$X.6000, stack[[4]]$X.6000,
stack[[5]]$X.6000, stack[[6]]$X.6000, stack[[7]]$X.6000, stack[[8]]$X.6000,
stack[[9]]$X.6000, stack[[10]]$X.6000, stack[[11]]$X.6000, stack[[12]]$X.6000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.5000, stack[[2]]$X.5000, stack[[3]]$X.5000, stack[[4]]$X.5000,
stack[[5]]$X.5000, stack[[6]]$X.5000, stack[[7]]$X.5000, stack[[8]]$X.5000,
stack[[9]]$X.5000, stack[[10]]$X.5000, stack[[11]]$X.5000, stack[[12]]$X.5000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.4000, stack[[2]]$X.4000, stack[[3]]$X.4000, stack[[4]]$X.4000,
stack[[5]]$X.4000, stack[[6]]$X.4000, stack[[7]]$X.4000, stack[[8]]$X.4000,
stack[[9]]$X.4000, stack[[10]]$X.4000, stack[[11]]$X.4000, stack[[12]]$X.4000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.3000, stack[[2]]$X.3000, stack[[3]]$X.3000, stack[[4]]$X.3000,
stack[[5]]$X.3000, stack[[6]]$X.3000, stack[[7]]$X.3000, stack[[8]]$X.3000,
stack[[9]]$X.3000, stack[[10]]$X.3000, stack[[11]]$X.3000, stack[[12]]$X.3000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.2000, stack[[2]]$X.2000, stack[[3]]$X.2000, stack[[4]]$X.2000,
stack[[5]]$X.2000, stack[[6]]$X.2000, stack[[7]]$X.2000, stack[[8]]$X.2000,
stack[[9]]$X.2000, stack[[10]]$X.2000, stack[[11]]$X.2000, stack[[12]]$X.2000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.1000, stack[[2]]$X.1000, stack[[3]]$X.1000, stack[[4]]$X.1000,
stack[[5]]$X.1000, stack[[6]]$X.1000, stack[[7]]$X.1000, stack[[8]]$X.1000,
stack[[9]]$X.1000, stack[[10]]$X.1000, stack[[11]]$X.1000, stack[[12]]$X.1000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X0, stack[[2]]$X0, stack[[3]]$X0, stack[[4]]$X0,
stack[[5]]$X0, stack[[6]]$X0, stack[[7]]$X0, stack[[8]]$X0,
stack[[9]]$X0, stack[[10]]$X0, stack[[11]]$X0, stack[[12]]$X0)
meansStack <- append(meansStack, s)
means[[i]] <- calc(meansStack, fun = mean, na.rm = T)
length(meansStack)
for (i in 1:length(meansStack)) {
means[[i]] <- calc(meansStack[[i]], fun = mean, na.rm = TRUE)
}
View(means)
plot(means[[1]])
plot(means)
plot(means[[2]])
plot(means[[3]])
plot(means[[4]])
plot(means[[5]])
brick(means)
var <- brick(means)
# can check this by overlaying the US map and checking edges
projection(var) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
writeRaster(stack(var), outfile, bylayer = TRUE, format='GTiff', overwrite = T)
outfile <- './data_and_analyses/env_data/Beyer/tifs/cloudiness/cloudiness.tif'
var <- brick(means)
# can check this by overlaying the US map and checking edges
projection(var) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
writeRaster(stack(var), outfile, bylayer = TRUE, format='GTiff', overwrite = T)
rasterList <- list.files(path = './data_and_analyses/env_data/Beyer/tifs/cloudiness',
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
allrasters <- stack(allrasters)
plot(allRasters)
plot(allrasters)
changeFileName <- function(i, year, var) {
oldFile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '/', var, '_' , i, '.tif')
# print(paste0("Old file name: ", oldFile))
newFile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '/', var, '_' , year, 'ybp.tif')
# print(paste0("New file name: ", newFile))
file.rename(oldFile, newFile)
}
run <- function(var, yr) {
i <- 1
v <- var
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
}
lapply('cloudiness', run, var2 = 21000)
run <- function(var, yr) {
i <- 1
v <- var
while(i <= 72) {
changeFileName(i, yr, v)
if (yr > 22000) {
# decrease year by 2000 increments
yr <- yr - 2000
} else {
# decrease year by 1000 increments
yr <- yr - 1000
}
i <- i + 1
}
}
lapply(c('cloudiness'), run, var2 = 21000)
lapply(c('cloudiness'), run, yr = 21000)
brick(file, varname = 'relative_humidity')
stack <- list()
means <- list()
for(i in 1:12){
f <- list(brick(file, varname = 'relative_humidity', level = i))
stack <- append(stack, f)
}
meansStack <- list()
s <- stack(stack[[1]]$X.21000, stack[[2]]$X.21000, stack[[3]]$X.21000, stack[[4]]$X.21000,
stack[[5]]$X.21000, stack[[6]]$X.21000, stack[[7]]$X.21000, stack[[8]]$X.21000,
stack[[9]]$X.21000, stack[[10]]$X.21000, stack[[11]]$X.21000, stack[[12]]$X.21000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.20000, stack[[2]]$X.20000, stack[[3]]$X.20000, stack[[4]]$X.20000,
stack[[5]]$X.20000, stack[[6]]$X.20000, stack[[7]]$X.20000, stack[[8]]$X.20000,
stack[[9]]$X.20000, stack[[10]]$X.20000, stack[[11]]$X.20000, stack[[12]]$X.20000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.19000, stack[[2]]$X.19000, stack[[3]]$X.19000, stack[[4]]$X.19000,
stack[[5]]$X.19000, stack[[6]]$X.19000, stack[[7]]$X.19000, stack[[8]]$X.19000,
stack[[9]]$X.19000, stack[[10]]$X.19000, stack[[11]]$X.19000, stack[[12]]$X.19000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.18000, stack[[2]]$X.18000, stack[[3]]$X.18000, stack[[4]]$X.18000,
stack[[5]]$X.18000, stack[[6]]$X.18000, stack[[7]]$X.18000, stack[[8]]$X.18000,
stack[[9]]$X.18000, stack[[10]]$X.18000, stack[[11]]$X.18000, stack[[12]]$X.18000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.17000, stack[[2]]$X.17000, stack[[3]]$X.17000, stack[[4]]$X.17000,
stack[[5]]$X.17000, stack[[6]]$X.17000, stack[[7]]$X.17000, stack[[8]]$X.17000,
stack[[9]]$X.17000, stack[[10]]$X.17000, stack[[11]]$X.17000, stack[[12]]$X.17000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.16000, stack[[2]]$X.16000, stack[[3]]$X.16000, stack[[4]]$X.16000,
stack[[5]]$X.16000, stack[[6]]$X.16000, stack[[7]]$X.16000, stack[[8]]$X.16000,
stack[[9]]$X.16000, stack[[10]]$X.16000, stack[[11]]$X.16000, stack[[12]]$X.16000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.15000, stack[[2]]$X.15000, stack[[3]]$X.15000, stack[[4]]$X.15000,
stack[[5]]$X.15000, stack[[6]]$X.15000, stack[[7]]$X.15000, stack[[8]]$X.15000,
stack[[9]]$X.15000, stack[[10]]$X.15000, stack[[11]]$X.15000, stack[[12]]$X.15000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.14000, stack[[2]]$X.14000, stack[[3]]$X.14000, stack[[4]]$X.14000,
stack[[5]]$X.14000, stack[[6]]$X.14000, stack[[7]]$X.14000, stack[[8]]$X.14000,
stack[[9]]$X.14000, stack[[10]]$X.14000, stack[[11]]$X.14000, stack[[12]]$X.14000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.13000, stack[[2]]$X.13000, stack[[3]]$X.13000, stack[[4]]$X.13000,
stack[[5]]$X.13000, stack[[6]]$X.13000, stack[[7]]$X.13000, stack[[8]]$X.13000,
stack[[9]]$X.13000, stack[[10]]$X.13000, stack[[11]]$X.13000, stack[[12]]$X.13000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.12000, stack[[2]]$X.12000, stack[[3]]$X.12000, stack[[4]]$X.12000,
stack[[5]]$X.12000, stack[[6]]$X.12000, stack[[7]]$X.12000, stack[[8]]$X.12000,
stack[[9]]$X.12000, stack[[10]]$X.12000, stack[[11]]$X.12000, stack[[12]]$X.12000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.11000, stack[[2]]$X.11000, stack[[3]]$X.11000, stack[[4]]$X.11000,
stack[[5]]$X.11000, stack[[6]]$X.11000, stack[[7]]$X.11000, stack[[8]]$X.11000,
stack[[9]]$X.11000, stack[[10]]$X.11000, stack[[11]]$X.11000, stack[[12]]$X.11000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.10000, stack[[2]]$X.10000, stack[[3]]$X.10000, stack[[4]]$X.10000,
stack[[5]]$X.10000, stack[[6]]$X.10000, stack[[7]]$X.10000, stack[[8]]$X.10000,
stack[[9]]$X.10000, stack[[10]]$X.10000, stack[[11]]$X.10000, stack[[12]]$X.10000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.9000, stack[[2]]$X.9000, stack[[3]]$X.9000, stack[[4]]$X.9000,
stack[[5]]$X.9000, stack[[6]]$X.9000, stack[[7]]$X.9000, stack[[8]]$X.9000,
stack[[9]]$X.9000, stack[[10]]$X.9000, stack[[11]]$X.9000, stack[[12]]$X.9000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.8000, stack[[2]]$X.8000, stack[[3]]$X.8000, stack[[4]]$X.8000,
stack[[5]]$X.8000, stack[[6]]$X.8000, stack[[7]]$X.8000, stack[[8]]$X.8000,
stack[[9]]$X.8000, stack[[10]]$X.8000, stack[[11]]$X.8000, stack[[12]]$X.8000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.7000, stack[[2]]$X.7000, stack[[3]]$X.7000, stack[[4]]$X.7000,
stack[[5]]$X.7000, stack[[6]]$X.7000, stack[[7]]$X.7000, stack[[8]]$X.7000,
stack[[9]]$X.7000, stack[[10]]$X.7000, stack[[11]]$X.7000, stack[[12]]$X.7000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.6000, stack[[2]]$X.6000, stack[[3]]$X.6000, stack[[4]]$X.6000,
stack[[5]]$X.6000, stack[[6]]$X.6000, stack[[7]]$X.6000, stack[[8]]$X.6000,
stack[[9]]$X.6000, stack[[10]]$X.6000, stack[[11]]$X.6000, stack[[12]]$X.6000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.5000, stack[[2]]$X.5000, stack[[3]]$X.5000, stack[[4]]$X.5000,
stack[[5]]$X.5000, stack[[6]]$X.5000, stack[[7]]$X.5000, stack[[8]]$X.5000,
stack[[9]]$X.5000, stack[[10]]$X.5000, stack[[11]]$X.5000, stack[[12]]$X.5000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.4000, stack[[2]]$X.4000, stack[[3]]$X.4000, stack[[4]]$X.4000,
stack[[5]]$X.4000, stack[[6]]$X.4000, stack[[7]]$X.4000, stack[[8]]$X.4000,
stack[[9]]$X.4000, stack[[10]]$X.4000, stack[[11]]$X.4000, stack[[12]]$X.4000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.3000, stack[[2]]$X.3000, stack[[3]]$X.3000, stack[[4]]$X.3000,
stack[[5]]$X.3000, stack[[6]]$X.3000, stack[[7]]$X.3000, stack[[8]]$X.3000,
stack[[9]]$X.3000, stack[[10]]$X.3000, stack[[11]]$X.3000, stack[[12]]$X.3000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.2000, stack[[2]]$X.2000, stack[[3]]$X.2000, stack[[4]]$X.2000,
stack[[5]]$X.2000, stack[[6]]$X.2000, stack[[7]]$X.2000, stack[[8]]$X.2000,
stack[[9]]$X.2000, stack[[10]]$X.2000, stack[[11]]$X.2000, stack[[12]]$X.2000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X.1000, stack[[2]]$X.1000, stack[[3]]$X.1000, stack[[4]]$X.1000,
stack[[5]]$X.1000, stack[[6]]$X.1000, stack[[7]]$X.1000, stack[[8]]$X.1000,
stack[[9]]$X.1000, stack[[10]]$X.1000, stack[[11]]$X.1000, stack[[12]]$X.1000)
meansStack <- append(meansStack, s)
s <- stack(stack[[1]]$X0, stack[[2]]$X0, stack[[3]]$X0, stack[[4]]$X0,
stack[[5]]$X0, stack[[6]]$X0, stack[[7]]$X0, stack[[8]]$X0,
stack[[9]]$X0, stack[[10]]$X0, stack[[11]]$X0, stack[[12]]$X0)
meansStack <- append(meansStack, s)
for (i in 1:length(meansStack)) {
means[[i]] <- calc(meansStack[[i]], fun = mean, na.rm = TRUE)
}
# this will fill the means list from 21,000 ybp to 0 ybp, so
# means[[1]] is 21,000 ybp, but means [[72]] is 0 ybp
means[[i]] <- calc(meansStack, fun = mean, na.rm = T)
library(raster)
# this will fill the means list from 21,000 ybp to 0 ybp, so
# means[[1]] is 21,000 ybp, but means [[72]] is 0 ybp
means[[i]] <- raster::calc(meansStack, fun = mean, na.rm = T)
outfile <- './data_and_analyses/env_data/Beyer/tifs/cloudiness/relative_humidity.tif'
var <- brick(means)
# can check this by overlaying the US map and checking edges
projection(var) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
writeRaster(stack(var), outfile, bylayer = TRUE, format='GTiff', overwrite = T)
run('relative_humidity', 21000)
outfile <- './data_and_analyses/env_data/Beyer/tifs/cloudiness/relative_humidity.tif'
var <- brick(means)
# can check this by overlaying the US map and checking edges
projection(var) <- '+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'
writeRaster(stack(var), outfile, bylayer = TRUE, format='GTiff', overwrite = T)
outfile <- './data_and_analyses/env_data/Beyer/tifs/relative_humidity/relative_humidity.tif'
writeRaster(stack(var), outfile, bylayer = TRUE, format='GTiff', overwrite = T)
run('relative_humidity', 21000)
setwd("/Users/laurenjenkins/Documents/MOBOT/PVMvsENM/")
library(raster)
# load variables
vars <- list.dirs(path = paste0('./data_and_analyses/env_data/Beyer/tifs'),
full.names=TRUE, recursive = TRUE)
clim <- stack(paste0('./data_and_analyses/env_data/Beyer/tifs/', vars, '.tif'))
outfile <- './data_and_analyses/env_data/Beyer/tifs/relative_humidity.tif'
writeRaster(stack(var), outfile, format = 'GTiff', overwrite = T)
# write as stacks for PCA
writeStacks <- function(var) {
outfile <- append(outfile, paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '.tif'))
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', var),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
writeRaster(stack(allRasters), outfile, format = 'GTiff', overwrite = T)
}
variables <- c('BIO1', 'BIO4', 'BIO5', 'BIO6', 'BIO7', 'BIO8', 'BIO9',
'BIO10', 'BIO11', 'BIO12', 'BIO13', 'BIO14', 'BIO15', 'BIO16',
'BIO17', 'BIO18', 'BIO19', 'cloudiness', 'relative_humidity')
lapply(variables, writeStacks)
# write as stacks for PCA
writeStacks <- function(var) {
outfile <- append(outfile, paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '.tif'))
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', var),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
writeRaster(stack(allrasters), outfile, format = 'GTiff', overwrite = T)
}
lapply(variables, writeStacks)
var <- 'BIO1'
outfile <- append(outfile, paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '.tif'))
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', var),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
writeRaster(stack(allrasters), outfile, format = 'GTiff', overwrite = T)
allrasters <- stack(allrasters)
writeRaster(allrasters, outfile, format = 'GTiff', overwrite = T)
outfile <- append(outfile, paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '_all.tif'))
writeRaster(allrasters, outfile, format = 'GTiff', overwrite = T)
plot(allrasters)
outfile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '.tif')
variables <- c('BIO1', 'BIO4', 'BIO5', 'BIO6', 'BIO7', 'BIO8', 'BIO9',
'BIO10', 'BIO11', 'BIO12', 'BIO13', 'BIO14', 'BIO15', 'BIO16',
'BIO17', 'BIO18', 'BIO19', 'cloudiness', 'relative_humidity')
lapply(variables, writeStacks)
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', var),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
allrasters <- stack(allrasters)
writeRaster(allrasters, outfile, format = 'GTiff', overwrite = T)
# write as stacks for PCA
writeStacks <- function(var) {
outfile <- paste0('./data_and_analyses/env_data/Beyer/tifs/', var, '.tif')
rasterList <- list.files(path = paste0('./data_and_analyses/env_data/Beyer/tifs/', var),
pattern='*.tif', all.files=TRUE, full.names=TRUE)
allrasters <- lapply(rasterList, raster)
allrasters <- stack(allrasters)
writeRaster(allrasters, outfile, format = 'GTiff', overwrite = T)
}
variables <- c('BIO1', 'BIO4', 'BIO5', 'BIO6', 'BIO7', 'BIO8', 'BIO9',
'BIO10', 'BIO11', 'BIO12', 'BIO13', 'BIO14', 'BIO15', 'BIO16',
'BIO17', 'BIO18', 'BIO19', 'cloudiness', 'relative_humidity')
lapply(variables, writeStacks)
# load variables
clim <- list.dir(path = './data_and_analyses/env_data/Beyer/tifs',
pattern='*.tif', all.files=TRUE, full.names=TRUE)
# load variables
clim <- list.files(path = './data_and_analyses/env_data/Beyer/tifs',
pattern='*.tif', all.files=TRUE, full.names=TRUE)
# load variables
clim <- stack(list.files(path = './data_and_analyses/env_data/Beyer/tifs',
pattern='*.tif', all.files=TRUE, full.names=TRUE))
View(clim)
# PCA on climate (only)
climDf <- as.data.frame(clim)
nonNas <- which(complete.cases(climDf))
climDf <- climDf[nonNas, ]
pca <- prcomp(climDf, center=TRUE, scale=TRUE)
pcPredictionNoNas <- predict(pca, climDf)
colnames(pcPredictionNoNas) <- paste0('pc', 1:21)
# predict PCA back to rasters
pcPrediction <- as.data.frame(clim)
pcPrediction[nonNas, ] <- pcPredictionNoNas
pcaRasts <- clim * NA
for (pc in 1:21) pcaRasts <- setValues(pcaRasts, values=pcPrediction[ , pc], layer=pc)
for (pc in 1:21) pcaRasts <- setValues(pcaRasts, values=pcPrediction[ , pc], layer=pc)
save.image('./PCA on Environmental Data')
