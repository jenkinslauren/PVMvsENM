ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
pdf(file = paste0('./predictions/pdf/', gcm, '_bioticVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
bvMeans$time <- paste0(abs(bvMeans$timeFrom), '-', abs(bvMeans$timeTo), ' kybp')
bvMeans$time <- factor(bvMeans$time, levels = rev(mixedsort(bvMeans$time)))
bvMeansF$time <- paste0(abs(bvMeansF$timeFrom), '-', abs(bvMeansF$timeTo), ' kybp')
bvMeansF$time <- factor(bvMeansF$time, levels = rev(mixedsort(bvMeansF$time)))
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeansF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvMax$time <- paste0(abs(bvMax$timeFrom), '-', abs(bvMax$timeTo), ' kybp')
bvMax$time <- factor(bvMax$time, levels = rev(mixedsort(bvMax$time)))
bvMaxF$time <- paste0(abs(bvMaxF$timeFrom), '-', abs(bvMaxF$timeTo), ' kybp')
bvMaxF$time <- factor(bvMaxF$time, levels = rev(mixedsort(bvMaxF$time)))
ggplot(bvMax, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMaxF, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvSum$time <- paste0(abs(bvSum$timeFrom), '-', abs(bvSum$timeTo), ' kybp')
bvSum$time <- factor(bvSum$time, levels = rev(mixedsort(bvSum$time)))
bvSumF$time <- paste0(abs(bvSumF$timeFrom), '-', abs(bvSumF$timeTo), ' kybp')
bvSumF$time <- factor(bvSumF$time, levels = rev(mixedsort(bvSumF$time)))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSumF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
# set limits
minBV <- min(c(min(bvMeans$centroidVelocity),
min(bvMax$centroidVelocity),
min(bvSum$centroidVelocity))) - 1000
maxBV <- max(c(max(bvMeans$centroidVelocity),
max(bvMax$centroidVelocity),
max(bvSum$centroidVelocity))) + 1000
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(minBV, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
ylim(minBV, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
ylim(minBV, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
# all equal y axes limits
# set limits
minBV <- min(c(min(bvMeans$centroidVelocity),
min(bvMax$centroidVelocity),
min(bvSum$centroidVelocity))) - 1000
maxBV <- max(c(max(bvMeans$centroidVelocity),
max(bvMax$centroidVelocity),
max(bvSum$centroidVelocity))) + 1000
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(minBV, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
min(bvMeans$centroidVelocity)
min(bvMax$centroidVelocity)
min(bvSum$centroidVelocity)
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
pdf(file = paste0('./predictions/pdf/', gcm, '_bioticVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
bvMeans$time <- paste0(abs(bvMeans$timeFrom), '-', abs(bvMeans$timeTo), ' kybp')
bvMeans$time <- factor(bvMeans$time, levels = rev(mixedsort(bvMeans$time)))
bvMeansF$time <- paste0(abs(bvMeansF$timeFrom), '-', abs(bvMeansF$timeTo), ' kybp')
bvMeansF$time <- factor(bvMeansF$time, levels = rev(mixedsort(bvMeansF$time)))
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeansF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvMax$time <- paste0(abs(bvMax$timeFrom), '-', abs(bvMax$timeTo), ' kybp')
bvMax$time <- factor(bvMax$time, levels = rev(mixedsort(bvMax$time)))
bvMaxF$time <- paste0(abs(bvMaxF$timeFrom), '-', abs(bvMaxF$timeTo), ' kybp')
bvMaxF$time <- factor(bvMaxF$time, levels = rev(mixedsort(bvMaxF$time)))
ggplot(bvMax, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMaxF, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvSum$time <- paste0(abs(bvSum$timeFrom), '-', abs(bvSum$timeTo), ' kybp')
bvSum$time <- factor(bvSum$time, levels = rev(mixedsort(bvSum$time)))
bvSumF$time <- paste0(abs(bvSumF$timeFrom), '-', abs(bvSumF$timeTo), ' kybp')
bvSumF$time <- factor(bvSumF$time, levels = rev(mixedsort(bvSumF$time)))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSumF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
# set limits
minBV <- min(c(min(bvMeans$centroidVelocity),
min(bvMax$centroidVelocity),
min(bvSum$centroidVelocity))) - 1000
maxBV <- max(c(max(bvMeans$centroidVelocity),
max(bvMax$centroidVelocity),
max(bvSum$centroidVelocity))) + 1000
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
gcmList <- c('Beyer', 'Lorenz_ccsm', 'ecbilt')
for(gcm in gcmList) {
load(paste0('./workspaces/06 - ', gcm, ' Projections'))
stackMeansList <- stack(meansList)
projection(stackMeansList) <- getCRS('albersNA')
bvMeans <- bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvMeansF <- bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = F)
stackMaxList <- stack(maxList)
projection(stackMaxList) <- getCRS('albersNA')
bvMax <- bioticVelocity(stackMaxList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvMaxF <- bioticVelocity(stackMaxList, times = seq(-21,0, by=1), onlyInSharedCells = F)
stackSumList <- stack(sumList)
projection(stackSumList) <- getCRS('albersNA')
bvSum <- bioticVelocity(stackSumList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvSumF <- bioticVelocity(stackSumList, times = seq(-21,0, by=1), onlyInSharedCells = F)
pdf(file = paste0('./predictions/pdf/', gcm, '_bioticVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
bvMeans$time <- paste0(abs(bvMeans$timeFrom), '-', abs(bvMeans$timeTo), ' kybp')
bvMeans$time <- factor(bvMeans$time, levels = rev(mixedsort(bvMeans$time)))
bvMeansF$time <- paste0(abs(bvMeansF$timeFrom), '-', abs(bvMeansF$timeTo), ' kybp')
bvMeansF$time <- factor(bvMeansF$time, levels = rev(mixedsort(bvMeansF$time)))
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeansF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvMax$time <- paste0(abs(bvMax$timeFrom), '-', abs(bvMax$timeTo), ' kybp')
bvMax$time <- factor(bvMax$time, levels = rev(mixedsort(bvMax$time)))
bvMaxF$time <- paste0(abs(bvMaxF$timeFrom), '-', abs(bvMaxF$timeTo), ' kybp')
bvMaxF$time <- factor(bvMaxF$time, levels = rev(mixedsort(bvMaxF$time)))
ggplot(bvMax, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMaxF, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvSum$time <- paste0(abs(bvSum$timeFrom), '-', abs(bvSum$timeTo), ' kybp')
bvSum$time <- factor(bvSum$time, levels = rev(mixedsort(bvSum$time)))
bvSumF$time <- paste0(abs(bvSumF$timeFrom), '-', abs(bvSumF$timeTo), ' kybp')
bvSumF$time <- factor(bvSumF$time, levels = rev(mixedsort(bvSumF$time)))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSumF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
# set limits
minBV <- min(c(min(bvMeans$centroidVelocity),
min(bvMax$centroidVelocity),
min(bvSum$centroidVelocity))) - 1000
maxBV <- max(c(max(bvMeans$centroidVelocity),
max(bvMax$centroidVelocity),
max(bvSum$centroidVelocity))) + 1000
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
# NS Quant Velocity
min05 <- min(c(min(bvMeans$nsQuantVelocity_quant0p05),
min(bvMax$nsQuantVelocity_quant0p05),
min(bvSum$nsQuantVelocity_quant0p05))) - 1000
min95 <- min(c(min(bvMeans$nsQuantVelocity_quant0p95),
min(bvMax$nsQuantVelocity_quant0p95),
min(bvSum$nsQuantVelocity_quant0p95))) - 1000
max05 <- max(c(max(bvMeans$nsQuantVelocity_quant0p05),
max(bvMax$nsQuantVelocity_quant0p05),
max(bvSum$nsQuantVelocity_quant0p05))) + 1000
max95 <- max(c(max(bvMeans$nsQuantVelocity_quant0p95),
max(bvMax$nsQuantVelocity_quant0p95),
max(bvSum$nsQuantVelocity_quant0p95))) + 1000
pdf(file = paste0('./predictions/pdf/', gcm, '_nsQuantVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
# save.image(file = paste0('./workspaces/06 - ', gcm, ' Projections'))
}
gcm <- 'Lorenz_ccsm'
load(paste0('./workspaces/06 - ', gcm, ' Projections'))
stackMeansList <- stack(meansList)
projection(stackMeansList) <- getCRS('albersNA')
bvMeans <- bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvMeansF <- bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = F)
stackMaxList <- stack(maxList)
projection(stackMaxList) <- getCRS('albersNA')
bvMax <- bioticVelocity(stackMaxList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvMaxF <- bioticVelocity(stackMaxList, times = seq(-21,0, by=1), onlyInSharedCells = F)
stackSumList <- stack(sumList)
projection(stackSumList) <- getCRS('albersNA')
bvSum <- bioticVelocity(stackSumList, times = seq(-21,0, by=1), onlyInSharedCells = T)
bvSumF <- bioticVelocity(stackSumList, times = seq(-21,0, by=1), onlyInSharedCells = F)
pdf(file = paste0('./predictions/pdf/', gcm, '_bioticVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
bvMeans$time <- paste0(abs(bvMeans$timeFrom), '-', abs(bvMeans$timeTo), ' kybp')
bvMeans$time <- factor(bvMeans$time, levels = rev(mixedsort(bvMeans$time)))
bvMeansF$time <- paste0(abs(bvMeansF$timeFrom), '-', abs(bvMeansF$timeTo), ' kybp')
bvMeansF$time <- factor(bvMeansF$time, levels = rev(mixedsort(bvMeansF$time)))
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeansF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvMax$time <- paste0(abs(bvMax$timeFrom), '-', abs(bvMax$timeTo), ' kybp')
bvMax$time <- factor(bvMax$time, levels = rev(mixedsort(bvMax$time)))
bvMaxF$time <- paste0(abs(bvMaxF$timeFrom), '-', abs(bvMaxF$timeTo), ' kybp')
bvMaxF$time <- factor(bvMaxF$time, levels = rev(mixedsort(bvMaxF$time)))
ggplot(bvMax, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMaxF, aes(time, centroidVelocity)) + geom_bar(stat = 'identity') +
ggtitle("Max (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
bvSum$time <- paste0(abs(bvSum$timeFrom), '-', abs(bvSum$timeTo), ' kybp')
bvSum$time <- factor(bvSum$time, levels = rev(mixedsort(bvSum$time)))
bvSumF$time <- paste0(abs(bvSumF$timeFrom), '-', abs(bvSumF$timeTo), ' kybp')
bvSumF$time <- factor(bvSumF$time, levels = rev(mixedsort(bvSumF$time)))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSumF, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums (shared cells = F)") + xlab("time period") + ylab("centroid velocity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
# set limits
minBV <- min(c(min(bvMeans$centroidVelocity),
min(bvMax$centroidVelocity),
min(bvSum$centroidVelocity))) - 1000
maxBV <- max(c(max(bvMeans$centroidVelocity),
max(bvMax$centroidVelocity),
max(bvSum$centroidVelocity))) + 1000
ggplot(bvMeans, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, centroidVelocity)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("centroid velocity") +
ylim(0, maxBV) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
# NS Quant Velocity
min05 <- min(c(min(bvMeans$nsQuantVelocity_quant0p05),
min(bvMax$nsQuantVelocity_quant0p05),
min(bvSum$nsQuantVelocity_quant0p05))) - 1000
min95 <- min(c(min(bvMeans$nsQuantVelocity_quant0p95),
min(bvMax$nsQuantVelocity_quant0p95),
min(bvSum$nsQuantVelocity_quant0p95))) - 1000
max05 <- max(c(max(bvMeans$nsQuantVelocity_quant0p05),
max(bvMax$nsQuantVelocity_quant0p05),
max(bvSum$nsQuantVelocity_quant0p05))) + 1000
max95 <- max(c(max(bvMeans$nsQuantVelocity_quant0p95),
max(bvMax$nsQuantVelocity_quant0p95),
max(bvSum$nsQuantVelocity_quant0p95))) + 1000
pdf(file = paste0('./predictions/pdf/', gcm, '_nsQuantVelocity.pdf'), width = 11, height = 8.5)
# no y axes limits
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# all equal y axes limits
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMeans, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Means") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvMax, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Max") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p05)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_05") +
ylim(min05, max05) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(bvSum, aes(time, nsQuantVelocity_quant0p95)) +
geom_bar(stat = 'identity') +
ggtitle("Sums") + xlab("time period") + ylab("NS_quant_95") +
ylim(min95, max95) + theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
bvMeans <- enmSdm::bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = T)
library(enmSdm)
bvMeans <- enmSdm::bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = T)
stackMeansList
bvMeans <- bioticVelocity(stackMeansList, times = seq(-21,0, by=1), onlyInSharedCells = T)
